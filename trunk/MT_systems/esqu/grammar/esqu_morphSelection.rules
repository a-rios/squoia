#
# Rules to solve morphological ambiguity (e.g. es: borracho, de: betrunken/Betrunkener (adj vs noun)
#
# Format:
# nodeSRC        morphTRGT     k/d     condition            ## comment
#
# condition: if the condition evaluates to true
# -> k=keep (keep only this option), d=delete  (delete this tranlsation option from output)
# my -> this node, parent -> parent node, child -> child node (true if condition is met for at least one child node), 
# rsibling/lsibling -> right/left sibling node (true if condition is met for at least one sibling node to the right/left)
# chunkparent: first ancestor that is a chunk

# IMPORTANT: sequence matters! the module works top down, so if you have a node with different 
# tranlsation option for which more than one condition evaluates to true: 
# if both are set to 'k' (keep this node, delete all others), only the first one will be kept!

#TODO: funktioniert nicht
#ebrio, machaq (ser), machasqa (estar), leave for language model
my.slem=ebrio	k	VRoot+Ag	my.smi=/NC/
my.slem=ebrio	k	VRoot+Perf	my.smi=/AQ/

# aqui, ahí, allá: kay, chay, haqay +Loc if static, +Dat with movement verbs
my.slem=aquí	k	PrnDem+Loc		!(xpath{ancestor::CHUNK[@type="grup-verb" or @type="coor-v"]/NODE[@sem="[+Mov]"]})
my.slem=aquí	k	PrnDem+Dat		xpath{ancestor::CHUNK[@type="grup-verb" or @type="coor-v"]/NODE[@sem="[+Mov]"]}
my.slem=ahí	k	PrnDem+Loc		!(xpath{ancestor::CHUNK[@type="grup-verb" or @type="coor-v"]/NODE[@sem="[+Mov]"]})
my.slem=ahí	k	PrnDem+Dat		xpath{ancestor::CHUNK[@type="grup-verb" or @type="coor-v"]/NODE[@sem="[+Mov]"]}
my.slem=allá	k	PrnDem+Loc		!(xpath{ancestor::CHUNK[@type="grup-verb" or @type="coor-v"]/NODE[@sem="[+Mov]"]})
my.slem=allá	k	PrnDem+Dat		xpath{ancestor::CHUNK[@type="grup-verb" or @type="coor-v"]/NODE[@sem="[+Mov]"]}

#################
#  main verbs
#################

# infinitive: -y or -na (-> hay que hacer, tener que hacer)
my.smi=VMN0000	k	obligative			 	chunkparent.verbform=obligative
my.smi=VMN0000	k	infinitive			 	!(chunkparent.verbform=obligative)

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------#

# MAIN VERBS

# relative clause -> la mujer que camina -> puriq warmi
# main clause, la mujer camina -> purin
# subordinated clause -spa (same subject) vs. -pti (same subject)

# switch-reference
my.smi=/VM...../	k	SS				 	chunkparent.verbform=SS
my.smi=/VM...../	k	DS				 	chunkparent.verbform=DS

# agentive relative clauses
my.smi=/VM...../	k	agentive			 	chunkparent.verbform=rel:agentive

# indicative present
my.smi=/VMIP.../	k	perfect				 	chunkparent.verbform=rel:not.agentive
my.smi=/VMIP.../	k	present				 	chunkparent.verbform=main

# indicative imperfect past
my.smi=/VMII.../	k	perfect				 	chunkparent.verbform=rel:not.agentive
my.smi=/VMII.../	k	perfect				 	chunkparent.verbform=perfect
#if main clause: keep options  direct, indirect or habitual past
my.smi=/VMII.../	d	agentive,perfect,SS,DS			chunkparent.verbform=main

# indicative past simple
my.smi=/VMIS.../	k	perfect			 		chunkparent.verbform=rel:not.agentive
#if main clause: keep options  direct, indirect past
my.smi=/VMIS.../	d	agentive,perfect,SS,DS			chunkparent.verbform=main

# indicative future
my.smi=/VMIF.../	k	future					chunkparent.verbform=main
my.smi=/VMIF.../	k	obligative				chunkparent.verbform=obligative
my.smi=/VMIF.../	k	obligative				chunkparent.verbform=rel:not.agentive

# conditional present, TODO: relative clauses in conditional?
my.smi=/VMIC.../	k	potential				chunkparent.verbform=main

# subjuntivo imperfecto
my.smi=/VMSI.../	k	potential				chunkparent.verbform=main
my.smi=/VMSI.../	k	perfect				 	chunkparent.verbform=perfect	 # complement clause
my.smi=/VMSI.../	k	obligative				chunkparent.verbform=obligative

# subjuntivo present, TODO: relative clauses?
my.smi=/VMSP.../	k	perfect				 	chunkparent.verbform=perfect	 # complement clause
my.smi=/VMSP.../	k	obligative				chunkparent.verbform=obligative	
my.smi=/VMSP.../	k	imperative				chunkparent.si=top && xpath{child::NODE[@slem="que"]} && xpath{parent::CHUNK[@type="grup-verb" or @type="coor-v"]/CHUNK[@type="F-term"]/NODE[@slem="!"]}
# main clause: potential or imperative (TODO: other options?)
my.smi=/VMSP.../	d	obligative,perfect,SS,DS			chunkparent.verbform=main


#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------#

#################
#auxiliary verbs 
#################

# HABER

#switch reference
my.smi=/VA...../ && my.slem=haber	k	SS				 	chunkparent.verbform=SS
my.smi=/VA...../ && my.slem=haber	k	DS				 	chunkparent.verbform=DS

# agentive relative clause
my.smi=/VA...../ && my.slem=haber	k	agentive				chunkparent.verbform=rel:agentive

# indicative future
my.smi=/VAIF.../ && my.slem=haber	k	obligative				chunkparent.verbform=obligative
my.smi=/VAIF.../ && my.slem=haber	k	obligative				chunkparent.verbform=rel:not.agentive
my.smi=/VAIF.../ && my.slem=haber	k	futureDisc				chunkparent.verbform=main

# imperfect past (había hecho) -> plusquamperfect
my.smi=/VAII.../ && my.slem=haber	k	perfect					chunkparent.verbform=rel:not.agentive
my.smi=/VAII.../ && my.slem=haber	k	indirectpast				chunkparent.verbform=main

# perfect past (hubo hecho)
my.smi=/VAIS.../ && my.slem=haber	k	perfect					chunkparent.verbform=rel:not.agentive
# in main clause: directpast or indirectpast, delete everything else
my.smi=/VAIS.../ && my.slem=haber	d	SS,DS,agentive,perfect			chunkparent.verbform=main

# indicative present TODO: main clause, he hecho-> ruwani or ruwarani?
my.smi=/VAIP.../ && my.slem=haber	k	perfect					chunkparent.verbform=rel:not.agentive
my.smi=/VAIP.../ && my.slem=haber	k	present					chunkparent.verbform=main

# subjuntivo hubiésemos/hubiéramos hecho, TODO: relative clauses??
my.smi=/VASI.../ && my.slem=haber	k	obligative				chunkparent.verbform=obligative
my.smi=/VASI.../ && my.slem=haber	k	pastpotential				chunkparent.verbform=main

# subjuntivo present: hayamos hecho, TODO: relative clause? main clause, present potential (noch nicht in dix, TODO?
my.smi=/VASP.../ && my.slem=haber	k	obligative				chunkparent.verbform=obligative
my.smi=/VASP.../ && my.slem=haber	k	potential				chunkparent.verbform=main

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------#

# ESTAR as auxiliary (only with gerund, in all other uses: estar mi=VM)

# switch reference
my.smi=/VA...../ && my.slem=estar	k	progressive_SS					chunkparent.verbform=SS
my.smi=/VA...../ && my.slem=estar	k	progressive_DS					chunkparent.verbform=DS

# agentive relative clause
my.smi=/VA...../ && my.slem=estar	k	progressive_agentive				chunkparent.verbform=rel:agentive

# indicative future, estaremos haciendo
my.smi=/VAIF.../ && my.slem=estar	k	progressive_future				chunkparent.verbform=main
my.smi=/VAIF.../ && my.slem=estar	k	progressive_obligative				chunkparent.verbform=rel:not.agentive

# past imperfect, estaba haciendo
my.smi=/VAII.../ && my.slem=estar	k	progressive_perfect				chunkparent.verbform=rel:not.agentive
# main verb: progressive_directpast or progressive_indirectpast, delete everything else
my.smi=/VAII.../ && my.slem=estar	d	progressive_agentive,progressive_perfect,progressive_DS,progressive_SS		chunkparent.verbform=main

# indicative past simple, estuve haciendo
my.smi=/VAIS.../ && my.slem=estar	k	progressive_perfect				chunkparent.verbform=rel:not.agentive
# main verb: progressive_directpast or progressive_indirectpast, delete everything else
my.smi=/VAIS.../ && my.slem=estar	d	progressive_agentive,progressive_perfect,progressive_DS,progressive_SS		chunkparent.verbform=main 

# indicative present
my.smi=/VAIP.../ && my.slem=estar	k	progressive_present				chunkparent.verbform=main
my.smi=/VAIP.../ && my.slem=estar	k	progressive_perfect				chunkparent.verbform=rel:not.agentive

# subjuntive past, estuvieramos haciendo, TODO: relative clauses?
my.smi=/VASI.../ && my.slem=estar	k	progressive_potential				chunkparent.verbform=main

# subjuntive present, estemos haciendo, TODO: relative clauses?
my.smi=/VASP.../ && my.slem=estar	k	progressive_potential				chunkparent.verbform=main
my.smi=/VASP.../ && my.slem=estar	k	progressive_obligative				chunkparent.verbform=obligative 
my.smi=/VASP.../ && my.slem=estar	k	progressive_perfect				chunkparent.verbform=perfect	#complement

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------#

# SER as passive or main verb (always VS)

# passive, always the same
my.smi=/VS...../ && my.slem=ser	k	passive				chunkparent.verbform=passive

# switch-reference, always the same:
my.smi=/VS...../ && my.slem=ser	k	SS				chunkparent.verbform=SS
my.smi=/VS...../ && my.slem=ser	k	DS				chunkparent.verbform=DS

# agentive relative clause, always the same (not true for non-agentive forms)
my.smi=/VS...../ && my.slem=ser	k	agentive			chunkparent.verbform=rel:agentive

# infinitive
my.smi=/VSN0000/ && my.slem=ser	k	infinitive			!(chunkparent.verbform=passive)&&!(chunkparent.verbform=obligative)
my.smi=/VSN0000/ && my.slem=ser	k	obligative			chunkparent.verbform=obligative

# conditional
my.smi=/VSIC.../ && my.slem=ser	k	potential			chunkparent.verbform=main

# future
my.smi=/VSIF.../ && my.slem=ser	k	future				chunkparent.verbform=main
my.smi=/VSIF.../ && my.slem=ser	k	obligative			chunkparent.verbform=obligative
my.smi=/VSIF.../ && my.slem=ser	k	obligative			chunkparent.verbform=rel:not.agentive

# past imperfect
my.smi=/VSII.../ && my.slem=ser	k	perfect				chunkparent.verbform=rel:not.agentive
# main verb: directpast, indirectpast or habitual past, delete everything else
my.smi=/VSII.../ && my.slem=ser	d	agentive,perfect,DS,SS,passive		chunkparent.verbform=main

# past simple
my.smi=/VSIP.../ && my.slem=ser	k	perfect				chunkparent.verbform=rel:not.agentive
# main verb: directpast or indirectpast, delete everything else
my.smi=/VSII.../ && my.slem=ser	d	agentive,perfect,DS,SS,passive		chunkparent.verbform=main

# present
my.smi=/VSIP.../ && my.slem=ser	k	present				chunkparent.verbform=main
my.smi=/VSIP.../ && my.slem=ser	k	perfect				chunkparent.verbform=rel:not.agentive

# subjuntive past
my.smi=/VSII.../ && my.slem=ser	k	obligative			chunkparent.verbform=obligative		#complement
my.smi=/VSII.../ && my.slem=ser	k	perfect				chunkparent.verbform=perfect		#complement
my.smi=/VSII.../ && my.slem=ser	k	potential			chunkparent.verbform=main

# participle sido: había sido cansado vs había sido pegado
my.smi=/VSP00S./ && my.slem=ser	k	passive				chunkparent.verbform=passive
my.smi=/VSP00S./ && my.slem=ser	k	participle			!(chunkparent.verbform=passive)

#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------#
